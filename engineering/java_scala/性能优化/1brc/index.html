
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://hannankan.github.io/homepage/engineering/java_scala/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/1brc/">
      
      
        <link rel="prev" href="../../maven/">
      
      
        <link rel="next" href="../1brc-review/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>1BRCç«èµ› - Hannan Kan</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-one-billion-row-challenge1brc-java" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Hannan Kan" class="md-header__button md-logo" aria-label="Hannan Kan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hannan Kan
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1BRCç«èµ›
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Hannan Kan" class="md-nav__button md-logo" aria-label="Hannan Kan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Hannan Kan
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../homepage_build/" class="md-nav__link">
        ä¸»é¡µæ­å»º
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          ä¹¦ç±
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ä¹¦ç±" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          ä¹¦ç±
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../book/books_index/" class="md-nav__link">
        ä¹¦å•
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" tabindex="0" aria-expanded="false">
          2023å¹´
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="2023å¹´" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          2023å¹´
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3_2_1" type="checkbox" id="__nav_3_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2_1" tabindex="0" aria-expanded="false">
          æŠ€æœ¯
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æŠ€æœ¯" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          æŠ€æœ¯
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../book/%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/" class="md-nav__link">
        ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../book/%E6%9E%B6%E6%9E%84%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93/" class="md-nav__link">
        ã€Šæ¶æ„æ•´æ´ä¹‹é“ã€‹
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" tabindex="0" aria-expanded="false">
          æºç 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æºç " data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          æºç 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../rfc/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E6%8A%80%E5%B7%A7%E6%80%BB%E7%BB%93/" class="md-nav__link">
        æŠ€å·§æ€»ç»“
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" tabindex="0" aria-expanded="true">
          å·¥ç¨‹å®è·µ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="å·¥ç¨‹å®è·µ" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          å·¥ç¨‹å®è·µ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/" class="md-nav__link">
        å·¥ç¨‹å®è·µ
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5_2" tabindex="0" aria-expanded="true">
          Java/Scala
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Java/Scala" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Java/Scala
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../%E5%B9%B6%E5%8F%91/" class="md-nav__link">
        å¹¶å‘
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../maven/" class="md-nav__link">
        Maven
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5_2_3" type="checkbox" id="__nav_5_2_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5_2_3" tabindex="0" aria-expanded="true">
          æ€§èƒ½ä¼˜åŒ–
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æ€§èƒ½ä¼˜åŒ–" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_3">
          <span class="md-nav__icon md-icon"></span>
          æ€§èƒ½ä¼˜åŒ–
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1BRCç«èµ›
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1BRCç«èµ›
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    æ¯”èµ›ä»‹ç»
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åŸç†å±‚é¢çš„æ€è€ƒğŸ¤”
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å…·ä½“ä¼˜åŒ–æŠ€æœ¯
  </a>
  
    <nav class="md-nav" aria-label="å…·ä½“ä¼˜åŒ–æŠ€æœ¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    æ•°æ®åº“ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç³»ç»Ÿå±‚é¢çš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvm" class="md-nav__link">
    JVM è¯­è¨€ç›¸å…³çš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    æ•°æ®ç»“æ„çš„é«˜æ•ˆä½¿ç”¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    å…¶ä»–ä¼˜åŒ–æ–¹æ³•
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1brc-review/" class="md-nav__link">
        1BRCç«èµ›ä»£ç èµæ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../threadLeakInvestigate/" class="md-nav__link">
        çº¿ç¨‹æ³„éœ²
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      
      
        <label class="md-nav__link" for="__nav_5_3" tabindex="0" aria-expanded="false">
          å¿«å­¦å¤§æ•°æ®
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="å¿«å­¦å¤§æ•°æ®" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          å¿«å­¦å¤§æ•°æ®
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro2BigDataComponent/outline/" class="md-nav__link">
        å­¦ä¹ å¤§çº²
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_5_3_2" type="checkbox" id="__nav_5_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_5_3_2" tabindex="0" aria-expanded="false">
          Hudi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Hudi" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_3_2">
          <span class="md-nav__icon md-icon"></span>
          Hudi
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../intro2BigDataComponent/hudi/hudi_intro/" class="md-nav__link">
        Hudi ç®€ä»‹
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" tabindex="0" aria-expanded="false">
          ä¼˜ç§€åšå®¢
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="ä¼˜ç§€åšå®¢" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          ä¼˜ç§€åšå®¢
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../blogs/" class="md-nav__link">
        ä¼˜ç§€åšå®¢æ±‡æ€»
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" tabindex="0" aria-expanded="false">
          å­¦ä¹ èµ„æ–™
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="å­¦ä¹ èµ„æ–™" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          å­¦ä¹ èµ„æ–™
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technical_materials/" class="md-nav__link">
        æŠ€æœ¯èµ„æ–™
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cultural_materials/" class="md-nav__link">
        äººæ–‡èµ„æ–™
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" tabindex="0" aria-expanded="false">
          å·¥å…·æ¨è
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="å·¥å…·æ¨è" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          å·¥å…·æ¨è
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../utils/efficiency_tools/" class="md-nav__link">
        æ•ˆç‡å·¥å…·
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    æ¯”èµ›ä»‹ç»
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    åŸç†å±‚é¢çš„æ€è€ƒğŸ¤”
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    å…·ä½“ä¼˜åŒ–æŠ€æœ¯
  </a>
  
    <nav class="md-nav" aria-label="å…·ä½“ä¼˜åŒ–æŠ€æœ¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    æ•°æ®åº“ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç³»ç»Ÿå±‚é¢çš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jvm" class="md-nav__link">
    JVM è¯­è¨€ç›¸å…³çš„ä¼˜åŒ–
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    æ•°æ®ç»“æ„çš„é«˜æ•ˆä½¿ç”¨
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    å…¶ä»–ä¼˜åŒ–æ–¹æ³•
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_puv">
    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡, è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äººæ¬¡
</span>

  <!-- Add scripts that need to run before here -->
  
                  



<h1 id="the-one-billion-row-challenge1brc-java">The One Billion Row Challenge(1BRC): Java å¤„ç†äº¿çº§åˆ«æ•°æ®çš„æ€§èƒ½è°ƒä¼˜</h1>
<p>è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸ªååˆ†æœ‰æ„æ€çš„æ¯”èµ› â€”â€” <a href="https://github.com/gunnarmorling/1brc?tab=readme-ov-file">The One Billion Row Challenge</a> ç®€ç§° 1BRCã€‚</p>
<h2 id="_1">æ¯”èµ›ä»‹ç»</h2>
<p>å®ƒæ˜¯ç”± <a href="https://twitter.com/gunnarmorling">Gunnar Morling</a> å‘èµ·çš„ä¸€é¡¹æŒ‘æˆ˜ï¼šç»™å®šè®¡ç®—ä»»åŠ¡ï¼Œæ¢ç´¢å…¶åœ¨åªä½¿ç”¨ modern Java çš„è¦æ±‚ä¸‹èƒ½è¾¾åˆ°çš„æœ€ä½³æ€§èƒ½ã€‚
æ¯”èµ›çš„è¦æ±‚åªèƒ½ä½¿ç”¨çº¯ Java æŠ€æœ¯ï¼Œä¸èƒ½ä½¿ç”¨ JNIã€ä¸èƒ½ä½¿ç”¨å…¶ä»– JVM-based è¯­è¨€ã€‚</p>
<p><strong>é€šè¿‡è¿™é¡¹æ¯”èµ›ï¼Œå¯ä»¥å­¦ä¹ åˆ° modern Java çš„å„ç§ä¼˜åŒ–æŠ€æœ¯</strong>ï¼Œæ¯”å¦‚</p>
<ul>
<li>ï¼ˆè™šæ‹Ÿï¼‰çº¿ç¨‹</li>
<li>Vector API å’Œ SIMD</li>
<li>GCä¼˜åŒ–</li>
<li>åˆ©ç”¨ AOT ç¼–è¯‘</li>
<li>ç­‰å„ç§å…¶ä»–"å¥‡æŠ€æ·«å·§"</li>
</ul>
<p><a href="https://twitter.com/gunnarmorling">Gunnar Morling</a> æ˜¯ä¸€ä½ååˆ†èµ„æ·±çš„ Java ç¨‹åºå‘˜ï¼Œä»–åœ¨ Twitter ä¸Šæœ‰ 48.9 k follower. </p>
<p><strong>è®¡ç®—ä»»åŠ¡</strong>ï¼šç»™å®šä¸€ä¸ª csv æ–‡æœ¬æ–‡ä»¶ï¼Œæ¯ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªé”®å€¼å¯¹ï¼Œé”®æ˜¯ string ç±»å‹ï¼Œå€¼æ˜¯ double ç±»å‹ï¼›è¦æ±‚å¯¹è¿™ä¸€äº¿è¡Œæ•°æ®åšèšåˆï¼ˆgroup byï¼‰æ“ä½œï¼Œç®—å‡ºæ¯ä¸ªåˆ†ç»„çš„ minã€meanã€maxã€‚</p>
<p>æœ¬æ–‡ååŠéƒ¨åˆ†æ˜¯è‡ªå·±æƒ³åˆ°çš„ä¼˜åŒ–æ€è·¯ã€‚</p>
<p>å¦å¤–ï¼Œå†æå‰æŒ–ä¸¤ä¸ªå‘ï¼Œæœ‰æ—¶é—´å†å¡« :)</p>
<ul>
<li>å­¦ä¹ ä¸€ä¸‹å‰å‡ åæäº¤çš„ä»£ç ï¼Œçœ‹èƒ½å¦å­¦åˆ°ä¸€äº›ä¸çŸ¥é“çš„ä¼˜åŒ–æŠ€å·§ã€‚</li>
<li>æ¯”èµ›è®¨è®ºåŒºè¿˜æœ‰å¾ˆå¤šäººæäº¤äº†é java çš„å®ç°ï¼Œå¯èƒ½ä¹Ÿè›®æœ‰æ„æ€ï¼Œæ¯”å¦‚ duckdb ç­‰</li>
</ul>
<h2 id="_2">åŸç†å±‚é¢çš„æ€è€ƒğŸ¤”</h2>
<p>ä¸€ä¸ªç¨‹åºæ‰§è¡Œæ—¶åˆ†ä¸ºå“ªå‡ ä¸ªé˜¶æ®µå‘¢ï¼Ÿä¸»è¦æ˜¯ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>I/O: åŒ…æ‹¬è¯»ã€å†™ä¸¤ä¸ªè¿‡ç¨‹ï¼Œå¯èƒ½çš„å½¢å¼åŒ…æ‹¬ æ–‡ä»¶è¯»å†™ã€ç½‘ç»œè¯»å†™</li>
<li>CPU è®¡ç®—</li>
<li>ç¼“å­˜ï¼šä¸­é—´ç»“æœå­˜åœ¨ memory æˆ–è€… cache ä¸­</li>
</ul>
<p>è¦æé«˜æ€§èƒ½çš„è¯ï¼Œæ¯ä¸ªé˜¶æ®µå®è§‚çš„ä¼˜åŒ–æ€æƒ³ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰ï¼š</p>
<ul>
<li>I/O: å‡å°‘é˜»å¡</li>
<li>CPU è®¡ç®—ï¼šæé«˜<strong>åˆ©ç”¨ç‡</strong>ï¼ˆå°½å¯èƒ½æ‰“æ»¡ CPUï¼‰ï¼Œæé«˜<strong>æœ‰æ•ˆè®¡ç®—</strong>çš„åˆ©ç”¨ç‡ï¼ˆå‡å°‘æµªè´¹ï¼‰</li>
<li>ç¼“å­˜ï¼šé«˜æ•ˆçš„ç¼“å­˜ç­–ç•¥ï¼Œå‡å°‘ I/O å¼€é”€ï¼Œå°½å¯èƒ½ä½¿ç”¨æ›´é«˜çº§çš„ç¼“å­˜ï¼ˆL1 cache &gt; L2 cache &gt; ... &gt; Lx cache &gt; RAM memory &gt; æŒä¹…åŒ–å†…å­˜PMEMï¼ˆPersistent Memoryï¼‰ &gt; SSD &gt; HDD)</li>
</ul>
<h2 id="_3">å…·ä½“ä¼˜åŒ–æŠ€æœ¯</h2>
<p>ä¸ªäººçœ‹æ³•ï¼Œå…·ä½“çš„ä¼˜åŒ–æŠ€æœ¯ä¸»è¦å¯ä»¥ä»å¦‚ä¸‹å‡ ä¸ªæ–¹é¢æ€è€ƒ</p>
<ul>
<li>ç”±èšåˆæ“ä½œï¼Œæƒ³åˆ°å¯ä»¥å€Ÿé‰´<strong>æ•°æ®åº“</strong>ä¸­çš„ä¼˜åŒ–æŠ€æœ¯</li>
<li>JVM è¯­è¨€ç›¸å…³çš„ä¼˜åŒ–</li>
<li>ç³»ç»Ÿå±‚é¢çš„ä¼˜åŒ–</li>
<li>æ•°æ®ç»“æ„çš„é«˜æ•ˆä½¿ç”¨</li>
<li>ç­‰</li>
</ul>
<h3 id="_4">æ•°æ®åº“ä¼˜åŒ–</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–ç®€ä»‹</th>
<th>ä¼˜åŒ–åŸç†</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>partition/åˆ†æ²»æ³•</code></td>
<td>I/O,CPU: å¹¶è¡Œè¯»å–ã€è®¡ç®—ï¼Œé™ä½ IOå¼€é”€ã€æå‡ CPU åˆ©ç”¨ç‡</td>
</tr>
<tr>
<td><code>batch processing/æ‰¹å¤„ç†</code></td>
<td>I/O,CPU,ç¼“å­˜: ç›¸æ¯”äº tuple-at-a-time, æœ‰æ•ˆåˆ©ç”¨ç³»ç»Ÿç¼“å­˜é™ä½ IO å¼€é”€çš„ï¼Œå‡å°‘äº† CPU ç­‰IOçš„æ—¶é—´; éœ€è¦åˆç†é€‰æ‹©ä¸€ä¸ª batch çš„å¤§å°ï¼Œä¿è¯æœ€å¤§åŒ– CPU åˆ©ç”¨ç‡çš„åŒæ—¶é¿å… OOM æˆ–è€… spill diskã€‚</td>
</tr>
<tr>
<td><code>spill disk/æº¢å†™ç£ç›˜</code></td>
<td>ç¼“å­˜ï¼šè€ƒè™‘å†…å­˜å¤§å°ï¼Œé’ˆå¯¹ä¸­é—´ç»“æœè®¾ç½®å†™ç£ç›˜çš„é˜ˆå€¼ï¼Œé¿å… OOM</td>
</tr>
</tbody>
</table>
<h3 id="_5">ç³»ç»Ÿå±‚é¢çš„ä¼˜åŒ–</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–ç®€ä»‹</th>
<th>ä¼˜åŒ–åŸç†</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>å¤šçº¿ç¨‹</code></td>
<td>æå‡ CPU åˆ©ç”¨ç‡ï¼Œ</td>
</tr>
<tr>
<td><code>å‘é‡åŒ–</code></td>
<td>Vector API/SIMD æŠ€æœ¯ï¼Œæå‡ cache å‘½ä¸­ç‡</td>
</tr>
<tr>
<td><a href="https://www.cnkirito.moe/learn-mmap/#mmap-vs-FileChannel">mmap</a></td>
<td>å‡å°‘ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„åˆ‡æ¢æ¬¡æ•°ï¼Œcpu å‹å¥½</td>
</tr>
<tr>
<td><code>å†™ç¼“å­˜</code></td>
<td>è®¾ç½®ç¼“å­˜åŒºï¼Œå¤§å°è®¾ç½®ä¸º 4kb æ•´æ•°å€ï¼Œé¿å…å†™æ”¾å¤§</td>
</tr>
</tbody>
</table>
<h3 id="jvm">JVM è¯­è¨€ç›¸å…³çš„ä¼˜åŒ–</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–ç®€ä»‹</th>
<th>ä¼˜åŒ–åŸç†</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GC ä¼˜åŒ–</code></td>
<td>åˆé€‚çš„ gcï¼Œå‡å°‘ STW æ—¶é—´ï¼Œæå‡ CPU åˆ©ç”¨ç‡</td>
</tr>
<tr>
<td><code>AOT ç¼–è¯‘ä¼˜åŒ–</code></td>
<td>ç›¸æ¯” jitï¼Œ å ç”¨æ›´å°‘å†…å­˜ã€æ›´å¿«è¾¾åˆ°å³°å€¼æ€§èƒ½</td>
</tr>
<tr>
<td><a href="https://tech.meituan.com/2019/02/14/talk-about-java-magic-class-unsafe.html">unsafeå’ŒDirectByteBuffer</a></td>
<td>ç›´æ¥æ“ä½œå †å¤–å†…å­˜ï¼Œé¿å…ä¸å¿…è¦çš„ gcï¼Œæé«˜ CPU æ•ˆç‡</td>
</tr>
</tbody>
</table>
<h3 id="_6">æ•°æ®ç»“æ„çš„é«˜æ•ˆä½¿ç”¨</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–ç®€ä»‹</th>
<th>ä¼˜åŒ–åŸç†</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>é«˜æ•ˆçš„ HashTable ï¼Œä½¿ç”¨javaè‡ªå¸¦çš„ã€guavaçš„æˆ–å…¶ä»–çš„</code></td>
<td>æ›´å°‘çš„å“ˆå¸Œç¢°æ’ï¼Œå‡å°‘ CPU æµªè´¹ï¼›åŒæ—¶ï¼Œé¿å…å ç”¨è¿‡å¤šå†…å­˜</td>
</tr>
</tbody>
</table>
<h3 id="_7">å…¶ä»–ä¼˜åŒ–æ–¹æ³•</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–ç®€ä»‹</th>
<th>ä¼˜åŒ–åŸç†</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.infoq.cn/article/a8kmnxdhbwmzxzsytlga">ç«ç„°å›¾ğŸ”¥</a></td>
<td>CPU ç«ç„°å›¾ï¼Œæ‰¾åˆ°çƒ­ç‚¹ä»£ç è·¯å¾„ï¼Œé’ˆå¯¹æ€§ä¼˜åŒ–ï¼›off-cpu ç«ç„°å›¾ï¼Œè¯†åˆ« I/Oã€ç½‘ç»œç­‰é˜»å¡åœºæ™¯å¯¼è‡´çš„æ€§èƒ½ä¸‹é™ï¼›é”ç«äº‰ã€æ­»é”å¯¼è‡´çš„æ€§èƒ½ä¸‹é™é—®é¢˜ï¼›å†…å­˜ç«ç„°å›¾ï¼Œåˆ†æå†…å­˜å ç”¨ã€æ³„éœ²é—®é¢˜</td>
</tr>
</tbody>
</table>





  <h2 id="__comments">Comments</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
  data-repo="HannanKan/homepage"
  data-repo-id="R_kgDOKMfeHA"
  data-category="Announcements"
  data-category-id="DIC_kwDOKMfeHM4CZXT3"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async>
</script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate" ? "dark" : "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate" ? "dark" : "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
  <!-- Add scripts that need to run afterwards here -->

              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 - now
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="mailto:<hannankan@foxmail.com>" target="_blank" rel="noopener" title="é‚®ç®±åœ°å€" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4l217.6 163.2c11.4 8.5 27 8.5 38.4 0l217.6-163.2c12.1-9.1 19.2-23.3 19.2-38.4 0-26.5-21.5-48-48-48H48zM0 176v208c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V176L294.4 339.2a63.9 63.9 0 0 1-76.8 0L0 176z"/></svg>
    </a>
  
    
    
    <a href="https://www.zhihu.com/people/HannanKan" target="_blank" rel="noopener" title="çŸ¥ä¹" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.7l167.6-182.9c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "content.code.select"], "search": "../../../../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>